{"ast":null,"code":"var _jsxFileName = \"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/user/AgendarAvaliacao.tsx\";\nimport { IonButton, IonCard, IonCardHeader, IonCardTitle, IonContent, IonDatetime, IonHeader, IonIcon, IonItem, IonLabel, IonList, IonPage, IonRow, IonSearchbar, IonTitle, IonToolbar, IonMenuButton, IonButtons, IonLoading, IonAlert } from \"@ionic/react\";\nimport { calendarOutline, personCircle, personCircleOutline } from \"ionicons/icons\";\nimport React from \"react\";\nimport { getAvaliacoesAgendadas, setAvaliacao } from \"../../models/API/EvolucaoAPI\";\nimport { getInstrutores } from \"../../models/API/UserAPI\";\nimport './css/AgendarAvaliacao.css';\nimport { assert } from \"console\";\nconst avalInicial = {\n  data: new Date().toLocaleString(),\n  instrutor_nome: \"\",\n  instrutor_email: \"\"\n};\nconst searchInit = {\n  query: \"\",\n  list_init: [],\n  list_now: []\n};\n\nclass AgendarAvaliacao extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = void 0;\n    this.state = {\n      email: props.email,\n      aval: avalInicial,\n      avals: [],\n      instrutores: new Map(),\n      pickInstrutor: searchInit,\n      loading: \"\",\n      alert: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    var avals = [];\n    var map = new Map();\n    var pick = this.state.pickInstrutor;\n    const res = await getAvaliacoesAgendadas(this.state.email);\n    const res2 = await getInstrutores();\n    await res.json().then(data => {\n      avals = JSON.parse(data).avaliacoes;\n    });\n    await res2.json().then(data => {\n      var ret = data.instrutores;\n      var i;\n\n      for (i in ret) {\n        map.set(i, ret[i]);\n        pick.list_init.push(ret[i]);\n        if (pick.list_now.length < 3) pick.list_now.push(ret[i]);\n      }\n    });\n    this.setState({\n      avals: avals,\n      pickInstrutor: pick,\n      instrutores: map\n    });\n  }\n\n  setDate(date) {\n    var aval = this.state.aval;\n    aval.data = date;\n    this.setState({\n      aval: aval\n    });\n  }\n\n  setQuery(query) {\n    console.log(this.state);\n    var pick = this.state.pickInstrutor;\n    pick.query = query;\n\n    if (query === \"\") {\n      pick.list_now = pick.list_init.copyWithin(0, 0).slice(0, 3);\n    } else {\n      pick.list_now = this.state.pickInstrutor.list_init.filter(value => value.toLowerCase().indexOf(query.toLowerCase()) >= 0).slice(0, 40);\n    }\n\n    this.setState({\n      pickInstrutor: pick\n    });\n  }\n\n  async selectInstrutor(nome) {\n    var aval = this.state.aval;\n    assert(this.state.instrutores !== undefined);\n    var mail = [...this.state.instrutores].find(([key, val]) => val == mail)[0];\n    var resetSearch = {\n      query: \"\",\n      list_now: [],\n      list_init: this.state.pickInstrutor.list_init\n    };\n    aval.instrutor_email = mail;\n    aval.instrutor_nome = nome;\n    this.setState({\n      aval: aval,\n      pickInstrutor: resetSearch\n    });\n  }\n\n  setAgendacao() {\n    this.setState({\n      loading: \"A criar plano...\"\n    });\n    setAvaliacao(this.state.email, this.state.aval).then(async value => {\n      console.log(\"Agendar response value: \\n\");\n      console.log(value);\n      this.setState({\n        loading: \"\"\n      });\n\n      switch (value.status) {\n        case 200:\n          this.setState({\n            alert: \"Avaliação marcada!\"\n          });\n          break;\n\n        case 400:\n          this.setState({\n            alert: \"Verifique se os campos estão válidos...\"\n          });\n          break;\n      }\n    }); //alert(\"Avaliação Marcada\");\n\n    this.componentDidMount();\n  }\n\n  render() {\n    var localVals = this.state.avals;\n    return React.createElement(IonPage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(IonHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(IonToolbar, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(IonButtons, {\n      slot: \"start\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(IonMenuButton, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    })), React.createElement(IonTitle, {\n      id: \"page-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"Agendar\"))), React.createElement(IonContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(IonLoading, {\n      isOpen: this.state.loading !== \"\",\n      onDidDismiss: () => {\n        this.setState({\n          loading: \"\"\n        });\n      },\n      message: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), React.createElement(IonAlert, {\n      isOpen: this.state.alert !== \"\",\n      onDidDismiss: () => this.setState({\n        alert: \"\"\n      }),\n      header: 'Aviso',\n      message: this.state.alert,\n      buttons: ['Ok, percebido!'],\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }), React.createElement(IonCard, {\n      className: \"cardAval\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(IonCardHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(IonCardTitle, {\n      className: \"cardTitle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"Agendar Avalia\\xE7\\xE3o\"), \" \"), React.createElement(IonButton, {\n      color: \"success\",\n      onClick: () => this.setAgendacao(),\n      slot: \"end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"Submeter\"))), React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      icon: calendarOutline,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      className: \"data\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \" \", React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"\\xA0\"), \"Data:\"), React.createElement(IonDatetime, {\n      displayFormat: \"DD-MM-YYYY HH:mm\",\n      value: this.state.aval.data,\n      onIonChange: e => this.setDate(e.detail.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    })), React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      icon: personCircleOutline,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, \"\\xA0Instrutor:\"), React.createElement(IonLabel, {\n      slot: \"end\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, this.state.aval.instrutor_nome)), React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, React.createElement(IonLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"Instrutor:\"), React.createElement(IonToolbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(IonSearchbar, {\n      value: this.state.pickInstrutor.query,\n      onIonChange: e => this.setQuery(e.detail.value),\n      placeholder: \"Email do instrutor...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }))), this.state.pickInstrutor.list_now.length !== 0 ? React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(IonList, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, this.state.pickInstrutor.list_now.map(element => {\n      return React.createElement(IonItem, {\n        key: element,\n        className: \"item\",\n        button: true,\n        onClick: () => this.selectInstrutor(element),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(IonIcon, {\n        className: \"icon\",\n        icon: personCircle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }), React.createElement(IonLabel, {\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, element));\n    }))) : React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    })), React.createElement(IonRow, {\n      className: \"avalRow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, localVals.map(elem => React.createElement(IonCard, {\n      key: elem.data + elem.instrutor_nome,\n      className: \"cardCol\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      icon: calendarOutline,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, \"\\xA0Data: \", elem.data)), React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      icon: personCircleOutline,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, \"\\xA0Instrutor: \", elem.instrutor_nome))))), React.createElement(IonCard, {\n      className: \"cardAval\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default AgendarAvaliacao;","map":{"version":3,"sources":["/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/user/AgendarAvaliacao.tsx"],"names":["IonButton","IonCard","IonCardHeader","IonCardTitle","IonContent","IonDatetime","IonHeader","IonIcon","IonItem","IonLabel","IonList","IonPage","IonRow","IonSearchbar","IonTitle","IonToolbar","IonMenuButton","IonButtons","IonLoading","IonAlert","calendarOutline","personCircle","personCircleOutline","React","getAvaliacoesAgendadas","setAvaliacao","getInstrutores","assert","avalInicial","data","Date","toLocaleString","instrutor_nome","instrutor_email","searchInit","query","list_init","list_now","AgendarAvaliacao","Component","constructor","props","state","email","aval","avals","instrutores","Map","pickInstrutor","loading","alert","componentDidMount","map","pick","res","res2","json","then","JSON","parse","avaliacoes","ret","i","set","push","length","setState","setDate","date","setQuery","console","log","copyWithin","slice","filter","value","toLowerCase","indexOf","selectInstrutor","nome","undefined","mail","find","key","val","resetSearch","setAgendacao","status","render","localVals","e","detail","element","elem"],"mappings":";AAAA,SAASA,SAAT,EAAoBC,OAApB,EAA6BC,aAA7B,EAA4CC,YAA5C,EAA0DC,UAA1D,EAAsEC,WAAtE,EAAmFC,SAAnF,EAA8FC,OAA9F,EAAuGC,OAAvG,EAAgHC,QAAhH,EAA0HC,OAA1H,EAAmIC,OAAnI,EAA4IC,MAA5I,EAAoJC,YAApJ,EAAkKC,QAAlK,EAA4KC,UAA5K,EAAwLC,aAAxL,EAAuMC,UAAvM,EAAmNC,UAAnN,EAA+NC,QAA/N,QAA+O,cAA/O;AACA,SAASC,eAAT,EAA0BC,YAA1B,EAAwCC,mBAAxC,QAAmE,gBAAnE;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,sBAAT,EAAiCC,YAAjC,QAAqD,8BAArD;AACA,SAASC,cAAT,QAA+B,0BAA/B;AACA,OAAO,4BAAP;AACA,SAASC,MAAT,QAAuB,SAAvB;AAgBA,MAAMC,WAA+B,GAAI;AACrCC,EAAAA,IAAI,EAAG,IAAIC,IAAJ,GAAWC,cAAX,EAD8B;AAErCC,EAAAA,cAAc,EAAG,EAFoB;AAGrCC,EAAAA,eAAe,EAAE;AAHoB,CAAzC;AAKA,MAAMC,UAAsB,GAAG;AAC3BC,EAAAA,KAAK,EAAG,EADmB;AAE3BC,EAAAA,SAAS,EAAG,EAFe;AAG3BC,EAAAA,QAAQ,EAAG;AAHgB,CAA/B;;AAMA,MAAMC,gBAAN,SAA+Bf,KAAK,CAACgB,SAArC,CAAmD;AAY/CC,EAAAA,WAAW,CAACC,KAAD,EAAa;AACpB,UAAMA,KAAN;AADoB,SAXxBC,KAWwB;AAEpB,SAAKA,KAAL,GAAW;AACPC,MAAAA,KAAK,EAAEF,KAAK,CAACE,KADN;AAEPC,MAAAA,IAAI,EAAGhB,WAFA;AAGPiB,MAAAA,KAAK,EAAG,EAHD;AAIPC,MAAAA,WAAW,EAAG,IAAIC,GAAJ,EAJP;AAKPC,MAAAA,aAAa,EAAGd,UALT;AAMPe,MAAAA,OAAO,EAAE,EANF;AAOPC,MAAAA,KAAK,EAAC;AAPC,KAAX;AASH;;AAED,QAAMC,iBAAN,GAAyB;AACrB,QAAIN,KAA2B,GAAE,EAAjC;AACA,QAAIO,GAAwB,GAAG,IAAIL,GAAJ,EAA/B;AACA,QAAIM,IAAgB,GAAG,KAAKX,KAAL,CAAWM,aAAlC;AACA,UAAMM,GAAG,GAAI,MAAM9B,sBAAsB,CAAC,KAAKkB,KAAL,CAAWC,KAAZ,CAAzC;AACA,UAAMY,IAAI,GAAI,MAAM7B,cAAc,EAAlC;AACA,UAAM4B,GAAG,CAACE,IAAJ,GAAWC,IAAX,CAAiB5B,IAAD,IAAQ;AAE1BgB,MAAAA,KAAK,GAAGa,IAAI,CAACC,KAAL,CAAW9B,IAAX,EAAiB+B,UAAzB;AACH,KAHK,CAAN;AAIA,UAAML,IAAI,CAACC,IAAL,GAAYC,IAAZ,CAAkB5B,IAAD,IAAQ;AAC3B,UAAIgC,GAAG,GAAGhC,IAAI,CAACiB,WAAf;AACA,UAAIgB,CAAJ;;AACA,WAAKA,CAAL,IAAUD,GAAV,EAAc;AACfT,QAAAA,GAAG,CAACW,GAAJ,CAAQD,CAAR,EAAUD,GAAG,CAACC,CAAD,CAAb;AACAT,QAAAA,IAAI,CAACjB,SAAL,CAAe4B,IAAf,CAAoBH,GAAG,CAACC,CAAD,CAAvB;AACA,YAAIT,IAAI,CAAChB,QAAL,CAAc4B,MAAd,GAAqB,CAAzB,EAA4BZ,IAAI,CAAChB,QAAL,CAAc2B,IAAd,CAAmBH,GAAG,CAACC,CAAD,CAAtB;AAC9B;AACA,KARK,CAAN;AAWA,SAAKI,QAAL,CAAc;AAAErB,MAAAA,KAAK,EAAEA,KAAT;AAAgBG,MAAAA,aAAa,EAAEK,IAA/B;AAAqCP,MAAAA,WAAW,EAAGM;AAAnD,KAAd;AACH;;AAEDe,EAAAA,OAAO,CAACC,IAAD,EAAe;AAClB,QAAIxB,IAAwB,GAAG,KAAKF,KAAL,CAAWE,IAA1C;AACAA,IAAAA,IAAI,CAACf,IAAL,GAAUuC,IAAV;AACA,SAAKF,QAAL,CAAc;AAACtB,MAAAA,IAAI,EAAGA;AAAR,KAAd;AACH;;AACDyB,EAAAA,QAAQ,CAAClC,KAAD,EAAgB;AACpBmC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAK7B,KAAjB;AACA,QAAIW,IAAI,GAAG,KAAKX,KAAL,CAAWM,aAAtB;AACAK,IAAAA,IAAI,CAAClB,KAAL,GAAaA,KAAb;;AACA,QAAGA,KAAK,KAAG,EAAX,EAAc;AAACkB,MAAAA,IAAI,CAAChB,QAAL,GAAegB,IAAI,CAACjB,SAAL,CAAeoC,UAAf,CAA0B,CAA1B,EAA4B,CAA5B,EAA+BC,KAA/B,CAAqC,CAArC,EAAuC,CAAvC,CAAf;AAAyD,KAAxE,MACQ;AACRpB,MAAAA,IAAI,CAAChB,QAAL,GAAiB,KAAKK,KAAL,CAAWM,aAAX,CAAyBZ,SAAzB,CAAmCsC,MAAnC,CAA2CC,KAAD,IAAUA,KAAK,CAACC,WAAN,GAAoBC,OAApB,CAA4B1C,KAAK,CAACyC,WAAN,EAA5B,KAAoD,CAAxG,CAAD,CAA6GH,KAA7G,CAAmH,CAAnH,EAAqH,EAArH,CAAhB;AAA0I;;AAC1I,SAAKP,QAAL,CAAc;AACVlB,MAAAA,aAAa,EAAGK;AADN,KAAd;AAIH;;AACF,QAAMyB,eAAN,CAAsBC,IAAtB,EAAoC;AAE/B,QAAInC,IAAI,GAAG,KAAKF,KAAL,CAAWE,IAAtB;AACAjB,IAAAA,MAAM,CAAE,KAAKe,KAAL,CAAWI,WAAX,KAA2BkC,SAA7B,CAAN;AACA,QAAIC,IAAS,GAAG,CAAC,GAAG,KAAKvC,KAAL,CAAWI,WAAf,EAA4BoC,IAA5B,CAAiC,CAAC,CAACC,GAAD,EAAMC,GAAN,CAAD,KAAgBA,GAAG,IAAIH,IAAxD,EAA8D,CAA9D,CAAhB;AACA,QAAII,WAAsB,GAAE;AAAClD,MAAAA,KAAK,EAAE,EAAR;AAAWE,MAAAA,QAAQ,EAAE,EAArB;AAAwBD,MAAAA,SAAS,EAAG,KAAKM,KAAL,CAAWM,aAAX,CAAyBZ;AAA7D,KAA5B;AAIAQ,IAAAA,IAAI,CAACX,eAAL,GAAuBgD,IAAvB;AACArC,IAAAA,IAAI,CAACZ,cAAL,GAAsB+C,IAAtB;AACA,SAAKb,QAAL,CAAc;AAAEtB,MAAAA,IAAI,EAAEA,IAAR;AAAcI,MAAAA,aAAa,EAAEqC;AAA7B,KAAd;AACH;;AAEDC,EAAAA,YAAY,GAAG;AACX,SAAKpB,QAAL,CAAc;AAACjB,MAAAA,OAAO,EAAG;AAAX,KAAd;AACAxB,IAAAA,YAAY,CAAC,KAAKiB,KAAL,CAAWC,KAAZ,EAAkB,KAAKD,KAAL,CAAWE,IAA7B,CAAZ,CAA+Ca,IAA/C,CACI,MAAOkB,KAAP,IAAsB;AAClBL,MAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYI,KAAZ;AACA,WAAKT,QAAL,CAAc;AAACjB,QAAAA,OAAO,EAAC;AAAT,OAAd;;AACA,cAAQ0B,KAAK,CAACY,MAAd;AACI,aAAK,GAAL;AAAW,eAAKrB,QAAL,CAAc;AAAChB,YAAAA,KAAK,EAAG;AAAT,WAAd;AAA8C;;AACzD,aAAK,GAAL;AAAW,eAAKgB,QAAL,CAAc;AAAChB,YAAAA,KAAK,EAAE;AAAR,WAAd;AAAmE;AAFlF;AAGE,KARV,EAFW,CAYX;;AACA,SAAKC,iBAAL;AACH;;AAGDqC,EAAAA,MAAM,GAAE;AAEJ,QAAIC,SAAS,GAAG,KAAK/C,KAAL,CAAWG,KAA3B;AAEA,WACI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEA,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,UAAD;AAAY,MAAA,KAAK,EAAC,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,UAAD;AAAY,MAAA,IAAI,EAAC,OAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADA,EAIA,oBAAC,QAAD;AAAU,MAAA,EAAE,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAJA,CADJ,CAFA,EAUJ,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,UAAD;AACF,MAAA,MAAM,EAAE,KAAKH,KAAL,CAAWO,OAAX,KAAqB,EAD3B;AAEF,MAAA,YAAY,EAAE,MAAM;AAAC,aAAKiB,QAAL,CAAc;AAACjB,UAAAA,OAAO,EAAE;AAAV,SAAd;AAA6B,OAFhD;AAGF,MAAA,OAAO,EAAE,KAAKP,KAAL,CAAWO,OAHlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,EAMA,oBAAC,QAAD;AACE,MAAA,MAAM,EAAE,KAAKP,KAAL,CAAWQ,KAAX,KAAmB,EAD7B;AAEE,MAAA,YAAY,EAAE,MAAM,KAAKgB,QAAL,CAAc;AAAChB,QAAAA,KAAK,EAAG;AAAT,OAAd,CAFtB;AAGE,MAAA,MAAM,EAAE,OAHV;AAIE,MAAA,OAAO,EAAE,KAAKR,KAAL,CAAWQ,KAJtB;AAKE,MAAA,OAAO,EAAE,CAAC,gBAAD,CALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANA,EAaJ,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAC,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACJ,oBAAC,YAAD;AAAc,MAAA,SAAS,EAAG,WAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAsC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAtC,MADI,EAEJ,oBAAC,SAAD;AAAW,MAAA,KAAK,EAAC,SAAjB;AAA2B,MAAA,OAAO,EAAE,MAAI,KAAKoC,YAAL,EAAxC;AAA6D,MAAA,IAAI,EAAC,KAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFI,CADJ,CADJ,EASI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEA,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAElE,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFA,EAGA,oBAAC,QAAD;AAAU,MAAA,SAAS,EAAC,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAA6B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAA7B,UAHA,EAIM,oBAAC,WAAD;AAAc,MAAA,aAAa,EAAC,kBAA5B;AAA+C,MAAA,KAAK,EAAE,KAAKsB,KAAL,CAAWE,IAAX,CAAgBf,IAAtE;AAA4E,MAAA,WAAW,EAAE6D,CAAC,IAAI,KAAKvB,OAAL,CAAauB,CAAC,CAACC,MAAF,CAAShB,KAAtB,CAA9F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJN,CATJ,EAgBI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAErD,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,EAEA,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFA,EAKA,oBAAC,QAAD;AAAU,MAAA,IAAI,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACO,KAAKoB,KAAL,CAAWE,IAAX,CAAgBZ,cADvB,CALA,CAhBJ,EA2BI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACM,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADN,EAEM,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACM,oBAAC,YAAD;AAAc,MAAA,KAAK,EAAE,KAAKU,KAAL,CAAWM,aAAX,CAAyBb,KAA9C;AAAqD,MAAA,WAAW,EAAEuD,CAAC,IAAI,KAAKrB,QAAL,CAAcqB,CAAC,CAACC,MAAF,CAAShB,KAAvB,CAAvE;AAAuG,MAAA,WAAW,EAAC,uBAAnH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADN,CAFN,CA3BJ,EAiCe,KAAKjC,KAAL,CAAWM,aAAX,CAAyBX,QAAzB,CAAkC4B,MAAlC,KAA2C,CAA3C,GAEX,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACS,KAAKvB,KAAL,CAAWM,aAAX,CAAyBX,QAAzB,CAAkCe,GAAlC,CACAwC,OAAD,IAAY;AAAE,aACd,oBAAC,OAAD;AAAS,QAAA,GAAG,EAAEA,OAAd;AAAuB,QAAA,SAAS,EAAC,MAAjC;AAAwC,QAAA,MAAM,EAAE,IAAhD;AAAuD,QAAA,OAAO,EAAE,MAAK,KAAKd,eAAL,CAAqBc,OAArB,CAArE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,OAAD;AAAS,QAAA,SAAS,EAAC,MAAnB;AAA0B,QAAA,IAAI,EAAGvE,YAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI,oBAAC,QAAD;AAAU,QAAA,KAAK,EAAC,SAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA4BuE,OAA5B,CAFJ,CADc;AAKZ,KAND,CADT,CADJ,CAFW,GAcJ,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA/CX,CAbI,EAiER,oBAAC,MAAD;AAAQ,MAAA,SAAS,EAAC,SAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACCH,SAAS,CAACrC,GAAV,CAAeyC,IAAD,IAEX,oBAAC,OAAD;AAAS,MAAA,GAAG,EAAEA,IAAI,CAAChE,IAAL,GAAYgE,IAAI,CAAC7D,cAA/B;AAA+C,MAAA,SAAS,EAAC,SAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAS,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAEZ,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAT,EAAoD,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAuByE,IAAI,CAAChE,IAA5B,CAApD,CADA,EAEA,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAS,oBAAC,OAAD;AAAS,MAAA,IAAI,EAAEP,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAT,EAAuD,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA4BuE,IAAI,CAAC7D,cAAjC,CAAvD,CAFA,CAFH,CADD,CAjEQ,EA4ER,oBAAC,OAAD;AAAS,MAAA,SAAS,EAAG,UAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA5EQ,CAVI,CADJ;AA8FP;;AAnMkD;;AAuMnD,eAAeM,gBAAf","sourcesContent":["import { IonButton, IonCard, IonCardHeader, IonCardTitle, IonContent, IonDatetime, IonHeader, IonIcon, IonItem, IonLabel, IonList, IonPage, IonRow, IonSearchbar, IonTitle, IonToolbar, IonMenuButton, IonButtons, IonLoading, IonAlert } from \"@ionic/react\";\nimport { calendarOutline, personCircle, personCircleOutline } from \"ionicons/icons\";\nimport React from \"react\";\nimport { getAvaliacoesAgendadas, setAvaliacao } from \"../../models/API/EvolucaoAPI\";\nimport { getInstrutores } from \"../../models/API/UserAPI\";\nimport './css/AgendarAvaliacao.css';\nimport { assert } from \"console\";\n\n\n\nexport interface AvaliacaoAgendada{\n    data : string\n    instrutor_nome : string\n    instrutor_email : string\n}\n\n\ninterface SearchBar{\n    query : string;\n    list_init : string[];\n    list_now : string[]\n}\nconst avalInicial : AvaliacaoAgendada  = {\n    data : new Date().toLocaleString(),\n    instrutor_nome : \"\",\n    instrutor_email: \"\"\n}\nconst searchInit : SearchBar = {\n    query : \"\",\n    list_init : [],\n    list_now : []\n}\n\nclass AgendarAvaliacao extends React.Component<any>{\n    state:{\n        email : string;\n        aval : AvaliacaoAgendada;\n        avals : AvaliacaoAgendada[];\n        instrutores : Map<string,string>;\n       pickInstrutor : SearchBar;\n       alert: string\n       loading: string\n       \n    }\n\n    constructor(props : any){\n        super(props);\n        this.state={\n            email :props.email,\n            aval : avalInicial,\n            avals : [],\n            instrutores : new Map(),\n            pickInstrutor : searchInit,\n            loading: \"\",\n            alert:\"\"\n        }\n    }\n    \n    async componentDidMount(){\n        var avals : AvaliacaoAgendada[] =[];\n        var map : Map<string,string> = new Map<string,string>() ;\n        var pick : SearchBar = this.state.pickInstrutor;\n        const res = (await getAvaliacoesAgendadas(this.state.email));\n        const res2 = (await getInstrutores());\n        await res.json().then((data)=>{\n\n            avals = JSON.parse(data).avaliacoes;\n        });\n        await res2.json().then((data)=>{\n            var ret = data.instrutores;\n            var i;\n            for( i in ret){\n           map.set(i,ret[i]);\n           pick.list_init.push(ret[i]);\n           if (pick.list_now.length<3) pick.list_now.push(ret[i]);\n        }\n        });\n\n        \n        this.setState({ avals: avals, pickInstrutor :pick ,instrutores : map });\n    }\n\n    setDate(date : string){\n        var aval : AvaliacaoAgendada = this.state.aval;\n        aval.data=date;\n        this.setState({aval : aval });\n    }\n    setQuery(query : string){\n        console.log(this.state);\n        var pick = this.state.pickInstrutor;\n        pick.query = query;\n        if(query===\"\"){pick.list_now= pick.list_init.copyWithin(0,0).slice(0,3)}\n            else{\n        pick.list_now = (this.state.pickInstrutor.list_init.filter((value)=> value.toLowerCase().indexOf(query.toLowerCase()) >= 0)).slice(0,40);}\n        this.setState({\n            pickInstrutor : pick\n        })\n\n    }\n   async selectInstrutor(nome: string) {\n\n        var aval = this.state.aval;\n        assert (this.state.instrutores !== undefined);\n        var mail: any = [...this.state.instrutores].find(([key, val]) => val == mail)[0];\n        var resetSearch :SearchBar ={query: \"\",list_now :[],list_init : this.state.pickInstrutor.list_init } \n        \n\n\n        aval.instrutor_email = mail;    \n        aval.instrutor_nome = nome;\n        this.setState({ aval: aval, pickInstrutor: resetSearch })\n    }\n\n    setAgendacao() {\n        this.setState({loading : \"A criar plano...\"});\n        setAvaliacao(this.state.email,this.state.aval).then(\n            async (value: any) => {\n                console.log(\"Agendar response value: \\n\");\n                console.log(value)\n                this.setState({loading:\"\"})\n                switch (value.status){\n                    case 200 : this.setState({alert : \"Avaliação marcada!\"});break;\n                    case 400 : this.setState({alert :\"Verifique se os campos estão válidos...\"}); break;\n                }})\n\n        //alert(\"Avaliação Marcada\");\n        this.componentDidMount();\n    }\n\n\n    render(){\n       \n        var localVals = this.state.avals;\n    \n        return(\n            <IonPage>\n\n            <IonHeader>\n                <IonToolbar color=\"primary\">\n                <IonButtons slot=\"start\">\n                    <IonMenuButton />\n                </IonButtons>\n                <IonTitle id=\"page-title\">Agendar</IonTitle>\n                </IonToolbar>\n                </IonHeader>\n        <IonContent>\n        <IonLoading\n      isOpen={this.state.loading!==\"\"}\n      onDidDismiss={() => {this.setState({loading: \"\"})}}\n      message={this.state.loading}\n    />\n        <IonAlert\n          isOpen={this.state.alert!==\"\"}\n          onDidDismiss={() => this.setState({alert : \"\"})}\n          header={'Aviso'}\n          message={this.state.alert}\n          buttons={['Ok, percebido!']}\n        />\n    <IonCard className=\"cardAval\">\n        <IonCardHeader>\n            <IonItem>\n        <IonCardTitle className = \"cardTitle\"><b>Agendar Avaliação</b> </IonCardTitle>\n        <IonButton color=\"success\" onClick={()=>this.setAgendacao()} slot=\"end\">\n            Submeter\n        </IonButton>\n        </IonItem>\n        </IonCardHeader>\n        <IonItem>\n\n        <IonIcon icon={calendarOutline}></IonIcon>\n        <IonLabel className=\"data\" > <b>&nbsp;</b>Data:</IonLabel>\n              <IonDatetime  displayFormat=\"DD-MM-YYYY HH:mm\" value={this.state.aval.data} onIonChange={e => this.setDate(e.detail.value!)}></IonDatetime>\n\n        </IonItem>\n        <IonItem>\n        <IonIcon icon={personCircleOutline}></IonIcon>\n        <IonLabel>\n        &nbsp;Instrutor: \n        </IonLabel>\n        <IonLabel slot=\"end\">\n              {this.state.aval.instrutor_nome}\n        </IonLabel>\n        \n        </IonItem>\n        \n        <IonItem>\n              <IonLabel>Instrutor:</IonLabel>\n              <IonToolbar>\n                    <IonSearchbar value={this.state.pickInstrutor.query} onIonChange={e => this.setQuery(e.detail.value!)} placeholder=\"Email do instrutor...\">\n                    </IonSearchbar>\n            </IonToolbar>\n        </IonItem>{this.state.pickInstrutor.list_now.length!==0? (\n        \n        <IonItem>\n            <IonList>\n                    {this.state.pickInstrutor.list_now.map(\n                    (element)=> { return(\n                    <IonItem key={element} className=\"item\" button={true}  onClick={() =>this.selectInstrutor(element)}>\n                        <IonIcon className=\"icon\" icon ={personCircle}></IonIcon>\n                        <IonLabel color=\"primary\" >{element}</IonLabel>\n                    </IonItem>\n                    )}\n                    )}\n    </IonList>\n    </IonItem>\n            ):(<React.Fragment></React.Fragment>) }\n            \n\n</IonCard>\n\n<IonRow className=\"avalRow\">\n{localVals.map((elem)=>\n    \n    <IonCard key={elem.data + elem.instrutor_nome} className=\"cardCol\">\n    <IonItem><IonIcon icon={calendarOutline }></IonIcon><IonLabel>&nbsp;Data: {elem.data}</IonLabel></IonItem>\n    <IonItem><IonIcon icon={personCircleOutline}></IonIcon><IonLabel>&nbsp;Instrutor: {elem.instrutor_nome}</IonLabel></IonItem>\n    </IonCard>\n   \n)}\n</IonRow>\n\n<IonCard className = \"cardAval\">\n\n</IonCard>\n</IonContent>\n\n</IonPage>\n        )\n}\n    \n}\n\nexport default AgendarAvaliacao;"]},"metadata":{},"sourceType":"module"}