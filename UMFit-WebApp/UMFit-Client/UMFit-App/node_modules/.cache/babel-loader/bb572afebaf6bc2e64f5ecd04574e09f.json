{"ast":null,"code":"var _jsxFileName = \"/home/joao/Desktop/Projeto-LI4/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/funcionario/EditarUtilizador.tsx\";\nimport React from \"react\";\nimport \"../css/RemoveUser.css\";\nimport { IonPage, IonHeader, IonTitle, IonToolbar, IonContent, IonItem, IonLabel, IonSearchbar, IonList, IonIcon, IonButton, IonSelectOption, IonSelect } from \"@ionic/react\";\nimport { person, informationCircle, atCircle, buildOutline } from 'ionicons/icons';\nimport { selectUser, updateUserCat, getAllClients } from \"../../models/API/UserAPI\"; //const testing = true;\n\nconst noSelection = {\n  index: -1,\n  name: \"string\",\n  email: \"string\",\n  cat: \"string\"\n};\n\nclass RemoveUser extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = void 0;\n    this.state = {\n      query: \"\",\n      lista_inicial: [],\n      render_next: [],\n      show_next: noSelection\n    };\n  }\n\n  async componentDidMount() {\n    var init = [\"Email1\", \"email2\", \"oogle.1\", \"gloogloog.2\", \"net.net\", \"yeet@3\", \"3.@yeet\"];\n    await getAllClients().then(async value => {\n      if (value.status === 200) {\n        var json = value.json();\n        await json.then(value => {\n          init = value.users;\n        });\n      } else {\n        alert(\"REQUEST ERROR \" + value.status);\n      }\n    }).catch(function (error) {\n      alert(\"Server is currently down... \\n\\n\".concat(\"Error details: \\n\\n\\t\").concat(error));\n    });\n    this.setState({\n      lista_inicial: init,\n      render_next: init\n    });\n  }\n\n  selectUser(index) {\n    var selection = {\n      name: \"\",\n      email: \"\",\n      cat: \"\",\n      index: index\n    }; //var apiCall:UserBasicInfo = {name:\"ByeBye\", email:\"net.net\", cat:\"Bot\", localidade:\"LocalHost\"} ;\n\n    if (index === this.state.show_next.index) selection = noSelection;else {\n      var res = selectUser(this.state.render_next[index]);\n      res.then(async value => {\n        if (value.status === 200) {\n          var json = value.json();\n          await json.then(value => {\n            const resValue = JSON.parse(value);\n            console.log(resValue.user);\n            selection = {\n              name: resValue.user.name,\n              email: resValue.user.email,\n              cat: resValue.user.categoria,\n              index: index\n            };\n            this.setState({\n              show_next: selection\n            });\n          });\n        } else {\n          alert(\"REQUEST ERROR \" + value.status);\n        }\n      }).catch(function (error) {\n        alert(\"Server is currently down... \\n\\n\".concat(\"Error details: \\n\\n\\t\").concat(error));\n      });\n    }\n    this.setState({\n      show_next: selection\n    });\n  }\n\n  setCat(e) {\n    e.stopPropagation();\n    var tmp = this.state.show_next;\n    tmp.cat = e.detail.value;\n    this.setState({\n      show_next: tmp\n    });\n  }\n\n  editarUser(email) {\n    var send = this.state.show_next;\n    var receive = updateUserCat({\n      userEmail: send.email,\n      tipo: send.cat\n    });\n    receive.then(async value => {\n      if (value.status !== 200) alert(\"REQUEST ERROR : \" + value.status);\n    });\n  }\n\n  setQuery(stringSearch) {\n    var resultado = this.state.lista_inicial.filter(function (value) {\n      return value.toLowerCase().indexOf(stringSearch.toLowerCase()) >= 0;\n    });\n    this.setState({\n      query: stringSearch,\n      render_next: resultado,\n      show_next: noSelection\n    });\n  }\n\n  render() {\n    var selected = this.state.show_next;\n    var renderList = this.state.render_next;\n    return React.createElement(IonPage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(IonHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(IonToolbar, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(IonTitle, {\n      id: \"page-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      className: \"icon\",\n      icon: buildOutline,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), \"Editar um Utilizador\"))), React.createElement(IonToolbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(IonSearchbar, {\n      value: this.state.query,\n      onIonChange: e => this.setQuery(e.detail.value),\n      placeholder: \"Email do utilizador...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    })), React.createElement(IonContent, {\n      className: \"PageContent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(IonList, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, renderList.map((element, index) => React.createElement(IonItem, {\n      key: element,\n      className: \"item\",\n      button: true,\n      onClick: () => this.selectUser(index),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      className: \"icon\",\n      icon: atCircle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), selected.index === index ? React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(IonLabel, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, element), React.createElement(IonList, {\n      className: \"inlist\",\n      lines: \"none\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(IonItem, {\n      className: \"inheritBackground\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      icon: person,\n      className: \"icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      color: \"primary\",\n      className: \"inheritBackground\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, selected.name)), React.createElement(IonItem, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(IonIcon, {\n      className: \"icon\",\n      icon: informationCircle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(IonLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"Tipo de s\\xF3cio: \"), React.createElement(IonSelect, {\n      value: selected.cat,\n      onClick: e => e.stopPropagation(),\n      onIonChange: e => this.setCat(e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(IonSelectOption, {\n      value: \"Cliente Standard\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"Standard\"), React.createElement(IonSelectOption, {\n      value: \"Cliente Premium\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Premium\"))), React.createElement(IonButton, {\n      color: \"warning\",\n      expand: \"block\",\n      onClick: () => this.editarUser(element),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Alterar\"))) : React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, React.createElement(IonLabel, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, element)))))));\n  }\n\n}\n\nexport default RemoveUser;","map":{"version":3,"sources":["/home/joao/Desktop/Projeto-LI4/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/funcionario/EditarUtilizador.tsx"],"names":["React","IonPage","IonHeader","IonTitle","IonToolbar","IonContent","IonItem","IonLabel","IonSearchbar","IonList","IonIcon","IonButton","IonSelectOption","IonSelect","person","informationCircle","atCircle","buildOutline","selectUser","updateUserCat","getAllClients","noSelection","index","name","email","cat","RemoveUser","Component","constructor","props","state","query","lista_inicial","render_next","show_next","componentDidMount","init","then","value","status","json","users","alert","catch","error","concat","setState","selection","res","resValue","JSON","parse","console","log","user","categoria","setCat","e","stopPropagation","tmp","detail","editarUser","send","receive","userEmail","tipo","setQuery","stringSearch","resultado","filter","toLowerCase","indexOf","render","selected","renderList","map","element"],"mappings":"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","sourcesContent":["import React from \"react\";\n\nimport \"../css/RemoveUser.css\"\nimport { IonPage, IonHeader, IonTitle, IonToolbar, IonContent, IonItem, IonLabel, IonSearchbar, IonList, IonIcon, IonButton, IonSelectOption, IonSelect } from \"@ionic/react\";\nimport{person,informationCircle,atCircle, buildOutline} from 'ionicons/icons'\nimport { selectUser,updateUserCat, getAllClients } from \"../../models/API/UserAPI\";\n\n\n//const testing = true;\n\ninterface SelectedUser{\n    index:number,\n    name:string,\n    email:string,\n    cat:string\n}\n\nconst noSelection : SelectedUser = {index:-1, name:\"string\", email:\"string\", cat:\"string\"}\n\nclass RemoveUser extends React.Component<any> {\n    \n    state:{\n        query:string,\n        lista_inicial:string[],\n        render_next:string[],\n        show_next:SelectedUser\n    }\n\n    constructor(props: any) {\n\n        super(props);\n\n        this.state = {  \n            query : \"\",\n            lista_inicial: [],\n            render_next: [],\n            show_next :noSelection\n        }\n    }\n\n    async componentDidMount(){\n        \n        var init:string[]=[\"Email1\",\"email2\",\"oogle.1\",\"gloogloog.2\",\"net.net\",\"yeet@3\",\"3.@yeet\",];\n        \n        await getAllClients()\n        .then(\n            async (value) =>{\n                if (value.status === 200) {              \n                    \n                    var json = value.json();\n\n                    await json.then((value) => {\n                        init= value.users;\n                    });\n               \n                    } else {\n                    alert(\"REQUEST ERROR \"+value.status);\n                }\n            }).catch(function(error) {\n              alert(\"Server is currently down... \\n\\n\".concat(\"Error details: \\n\\n\\t\").concat(error));\n            });\n    \n\n        this.setState({\n            lista_inicial: init,\n            render_next: init\n        })\n\n    }\n    selectUser(index:number):void{\n        \n        var selection ={name:\"\", email:\"\", cat:\"\",index:index};\n        \n        //var apiCall:UserBasicInfo = {name:\"ByeBye\", email:\"net.net\", cat:\"Bot\", localidade:\"LocalHost\"} ;\n        if(index===this.state.show_next.index) selection=noSelection; \n        else{\n        \n        var res = selectUser(this.state.render_next[index]);\n        res.then(\n            async (value) =>{\n                if (value.status === 200) {              \n                    var json = value.json();\n                    await json.then((value) =>  {\n                        const resValue = JSON.parse(value);\n                        console.log(resValue.user)\n                        selection = {name:resValue.user.name,\n                                    email:resValue.user.email,\n                                    cat:resValue.user.categoria,\n                                    index:index}\n                        this.setState({show_next : selection})\n                    });\n                } else {\n                    alert(\"REQUEST ERROR \"+value.status);\n                }\n            }).catch(function(error) {\n              alert(\"Server is currently down... \\n\\n\".concat(\"Error details: \\n\\n\\t\").concat(error));\n            });\n        \n    }\n    \n        this.setState({show_next : selection})\n    }\n\n    setCat(e : any){\n        e.stopPropagation();\n        var tmp =this.state.show_next;\n        tmp.cat=e.detail.value!;\n        this.setState({ show_next: tmp })\n    }\n\n    editarUser(email: string) {\n        var send = this.state.show_next;\n        var receive = updateUserCat({userEmail: send.email,tipo : send.cat });\n        receive.then(\n            async (value) =>{\n                if (value.status !== 200) alert(\"REQUEST ERROR : \"+value.status);\n            }\n        )\n    }\n\n    setQuery(stringSearch: any) {\n        var resultado = this.state.lista_inicial\n            .filter(function(value){return value.toLowerCase().indexOf(stringSearch.toLowerCase()) >= 0;});\n        this.setState({\n        \n            query: stringSearch,\n            render_next: resultado,\n            show_next:noSelection\n        })\n    }\n    render() {\n\n        var selected= this.state.show_next;\n        var renderList = this.state.render_next;\n\n        return(\n            \n            <IonPage>\n\n                <IonHeader>\n                <IonToolbar color=\"primary\">\n                    <IonTitle id=\"page-title\">\n                        <IonIcon className=\"icon\" icon ={buildOutline}></IonIcon>\n                        Editar um Utilizador\n                    </IonTitle>\n                </IonToolbar>\n                </IonHeader>\n                <IonToolbar>\n                <IonSearchbar value={this.state.query} onIonChange={e => this.setQuery(e.detail.value!)} placeholder=\"Email do utilizador...\">\n                </IonSearchbar>\n                </IonToolbar>\n    \n                <IonContent className=\"PageContent\">\n                \n                <IonList>\n                {renderList.map(\n                (element,index)=>\n                <IonItem key={element} className=\"item\" button={true}  onClick={() =>this.selectUser(index)}>\n                    <IonIcon className=\"icon\" icon ={atCircle}></IonIcon>\n                    {selected.index===index?\n                    <React.Fragment >\n                    <IonLabel color=\"primary\" >{element}</IonLabel>\n                    <IonList className=\"inlist\" lines=\"none\"  >\n                            <IonItem className=\"inheritBackground\" >\n                            <IonIcon icon={person} className=\"icon\" ></IonIcon>\n                            <IonLabel color=\"primary\" className=\"inheritBackground\">{selected.name}</IonLabel>\n                            </IonItem>\n\n                            <IonItem>\n                                <IonIcon className =\"icon\" icon={informationCircle}></IonIcon>\n                                <IonLabel>Tipo de sócio: </IonLabel>    \n                                <IonSelect value={selected.cat} onClick={(e)=> e.stopPropagation()} onIonChange={(e) =>this.setCat(e)}>\n                                    <IonSelectOption value=\"Cliente Standard\">Standard</IonSelectOption>\n                                    <IonSelectOption value=\"Cliente Premium\">Premium</IonSelectOption>\n                                </IonSelect>\n\n                            </IonItem>\n\n                            <IonButton color=\"warning\" expand=\"block\" onClick={()=>this.editarUser(element)}>\n                                Alterar     \n                            </IonButton>\n                              \n                    </IonList>\n                    </React.Fragment>\n                    \n                    :\n                    <React.Fragment>\n                    <IonLabel color=\"primary\" >{element}</IonLabel>\n                    </React.Fragment>\n                    }\n                    \n                    </IonItem> \n                    )}\n                \n                </IonList>\n                </IonContent>\n    \n            </IonPage>    \n        );\n    }\n    \n}\nexport default RemoveUser;"]},"metadata":{},"sourceType":"module"}