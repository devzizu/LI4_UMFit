{"ast":null,"code":"import _classCallCheck from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/inherits\";import{IonButton,IonCol,IonContent,IonDatetime,IonGrid,IonHeader,IonIcon,IonInput,IonItem,IonLabel,IonLoading,IonPage,IonRow,IonSelect,IonSelectOption,IonText,IonTitle,IonToolbar}from\"@ionic/react\";import sha256 from\"fast-sha256\";import{calendarOutline,cardOutline,codeWorkingOutline,locationOutline,mailOutline,peopleCircleOutline,personOutline,transgenderOutline}from\"ionicons/icons\";import React from\"react\";import{createUserAPI}from\"../../models/API/UserAPI\";import{getTestValueUser,User}from\"../../models/Other/User\";import\"../css/InserirUtilizador.css\";//---------------------------------------------------------------------------------------------------------------------------------\nvar InserirUtilizador=/*#__PURE__*/function(_React$Component){_inherits(InserirUtilizador,_React$Component);function InserirUtilizador(props){var _this;_classCallCheck(this,InserirUtilizador);_this=_possibleConstructorReturn(this,_getPrototypeOf(InserirUtilizador).call(this,props));_this.state=void 0;_this.stateToAPI=void 0;_this.state={nome_completo:\"\",email:\"\",password:\"\",localidade:\"\",nif:\"\",tipoDeSocio:\"\",genero:\"\",data_nascimento:\"1999-02-20\",categoria:\"\",loadingAPI:false,overflow:\"\",popup:\"\"};_this.stateToAPI={newUser:getTestValueUser(),passwordHash:\"\"};return _this;}_createClass(InserirUtilizador,[{key:\"createUserState\",value:function createUserState(){var _this2=this;this.setState({loadingAPI:true});var genero=-2;switch(this.state.genero){case\"Masculino\":genero=1;break;case\"Feminino\":genero=0;break;default:genero=-1;break;}var categoria=\"NÃ£o tem\";var socio=this.state.tipoDeSocio;if(this.state.tipoDeSocio===\"Cliente Premium\"){categoria=\"Premium\";socio=\"Cliente\";}else if(this.state.tipoDeSocio===\"Cliente Standard\"){categoria=\"Standard\";socio=\"Cliente\";}var user=new User(socio,this.state.email,parseInt(this.state.nif),this.state.nome_completo,genero,this.state.data_nascimento,this.state.localidade,categoria);var pass_enc=new TextEncoder();var encoded=pass_enc.encode(this.state.password);var hash256=Buffer.from(sha256(encoded)).toString('hex').toUpperCase();this.stateToAPI={newUser:user,passwordHash:hash256};createUserAPI(this.stateToAPI).then(function(res){if(res.status===200)alert(\"Criou um utilizador com sucesso!\");else return alert(\"Credenciais Invalidas\");res.json();}).then(function(jsonData){_this2.setState({loadingAPI:false});console.log(\"Got json:\");console.log(jsonData);}).finally(function(){window.location.reload();});}},{key:\"clearState\",value:function clearState(){this.setState({nome_completo:\"\",email:\"\",password:\"\",localidade:\"\",nif:\"\",tipoDeSocio:\"\",genero:\"\",data_nascimento:\"1999-02-20\"});}},{key:\"render\",value:function render(){var _this3=this;return React.createElement(IonPage,null,React.createElement(IonHeader,null,React.createElement(IonToolbar,{color:\"primary\"},React.createElement(IonTitle,{id:\"page-title\"},\"Novo Utilizador\"))),React.createElement(IonContent,{className:\"PageContent\"},React.createElement(IonGrid,{className:\"PageGrid\"},React.createElement(IonRow,null,React.createElement(IonCol,{size:\"2.5\",className:\"Row1ProfilePic\"},React.createElement(\"img\",{className:\"profilePicture\",src:require('../../imgs/perfil_pic.png'),alt:\"Loading...\"})),React.createElement(IonCol,null,React.createElement(IonGrid,null,React.createElement(\"div\",{className:\"separador\"}),React.createElement(IonRow,null,React.createElement(IonCol,{className:\"FirstForm\"},React.createElement(IonItem,null,React.createElement(IonIcon,{slot:\"start\",icon:personOutline}),React.createElement(IonLabel,{position:\"floating\"},\"Nome Completo\",React.createElement(IonText,{color:\"danger\"},\"*\"),React.createElement(IonText,{color:parseInt(this.state.overflow.split('/',1)[0])>=20?\"danger\":\"secondary\"},this.state.overflow.length>0?'  ('+this.state.overflow+')':\"\")),React.createElement(IonInput,{required:true,value:this.state.nome_completo,onIonChange:function onIonChange(e){var ret=e.detail.value;ret=ret.split(\" \",1)[0];_this3.setState({overflow:ret.length>0?+ret.length+\"/20\":\"\",nome_completo:e.detail.value});}})),React.createElement(IonItem,null,React.createElement(IonIcon,{slot:\"start\",icon:mailOutline}),React.createElement(IonLabel,{position:\"floating\"},\"E-Mail \",React.createElement(IonText,{color:\"danger\"},\"*\")),React.createElement(IonInput,{required:true,type:\"email\",value:this.state.email,onIonChange:function onIonChange(e){_this3.setState({email:e.target.value});}})),React.createElement(IonItem,null,React.createElement(IonIcon,{slot:\"start\",icon:codeWorkingOutline}),React.createElement(IonLabel,{position:\"floating\"},\"Definir a password \",React.createElement(IonText,{color:\"danger\"},\"*\")),React.createElement(IonInput,{type:\"password\",required:true,value:this.state.password,onIonChange:function onIonChange(e){_this3.setState({password:e.target.value});}})),React.createElement(IonItem,null,React.createElement(IonIcon,{slot:\"start\",icon:locationOutline}),React.createElement(IonLabel,{position:\"floating\"},\"Localidade\"),React.createElement(IonInput,{value:this.state.localidade,onIonChange:function onIonChange(e){_this3.setState({localidade:e.target.value});}})),React.createElement(IonItem,null,React.createElement(IonIcon,{slot:\"start\",icon:cardOutline}),React.createElement(IonLabel,{position:\"floating\"},\"Nif\"),React.createElement(IonInput,{required:true,pattern:\"[0-9]*\",type:\"number\",value:this.state.nif,onIonChange:function onIonChange(e){_this3.setState({nif:e.target.value});}})))),React.createElement(\"div\",{className:\"separador\"}),React.createElement(IonRow,null,React.createElement(IonCol,null,React.createElement(IonItem,{className:\"SelectUser\"},React.createElement(IonIcon,{slot:\"start\",icon:peopleCircleOutline}),React.createElement(IonLabel,null,\"Tipo de s\\xF3cio: \"),React.createElement(IonSelect,{value:this.state.tipoDeSocio,onIonChange:function onIonChange(e){return _this3.setState({tipoDeSocio:e.detail.value});}},React.createElement(IonSelectOption,{value:\"Cliente Standard\"},\"Cliente Standard\"),React.createElement(IonSelectOption,{value:\"Cliente Premium\"},\"Cliente Premium\"),React.createElement(IonSelectOption,{value:\"Instrutor\"},\"Instrutor\"),React.createElement(IonSelectOption,{value:\"Rececionista\"},\"Rececionista\"))),React.createElement(IonItem,{className:\"SelectGender\"},React.createElement(IonIcon,{slot:\"start\",icon:transgenderOutline}),React.createElement(IonLabel,null,\"G\\xE9nero: \"),React.createElement(IonSelect,{value:this.state.genero,onIonChange:function onIonChange(e){return _this3.setState({genero:e.detail.value});}},React.createElement(IonSelectOption,{value:\"Masculino\"},\"Masculino\"),React.createElement(IonSelectOption,{value:\"Feminino\"},\"Feminino\"),React.createElement(IonSelectOption,{value:\"N\\xE3o especificar\"},\"N\\xE3o especificar\"))),React.createElement(IonItem,{className:\"SelectDate\"},React.createElement(IonIcon,{slot:\"start\",icon:calendarOutline}),React.createElement(IonLabel,null,React.createElement(\"div\",{className:\"textResponsive\"},\"Data de Nasc.:\")),React.createElement(IonDatetime,{value:this.state.data_nascimento,onIonChange:function onIonChange(e){_this3.setState({data_nascimento:e.detail.value});}})))),React.createElement(\"div\",{className:\"separador\"}),React.createElement(IonRow,{className:\"buttonWrapper\"},React.createElement(IonCol,null,React.createElement(IonButton,{className:\"submitUser\",expand:\"block\",color:\"success\",onClick:function onClick(event){event.preventDefault();_this3.createUserState();}},\"Criar novo utilizador\")),React.createElement(IonCol,null,React.createElement(IonButton,{className:\"clearForm\",expand:\"block\",color:\"light\",onClick:function onClick(){_this3.clearState();}},\"Limpar formul\\xE1rio\"))))))),React.createElement(IonLoading,{isOpen:this.state.loadingAPI,message:'Please wait...'})));}}]);return InserirUtilizador;}(React.Component);export default InserirUtilizador;/*\n        (nome + , email + , nif + , data_nasc, genero, categoria, localidade + ), \n        tipo (0:cliente, 1:instrutor, 2:rececionista)\n        hash password\n    */","map":{"version":3,"sources":["/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/funcionario/InserirUtilizador.tsx"],"names":["IonButton","IonCol","IonContent","IonDatetime","IonGrid","IonHeader","IonIcon","IonInput","IonItem","IonLabel","IonLoading","IonPage","IonRow","IonSelect","IonSelectOption","IonText","IonTitle","IonToolbar","sha256","calendarOutline","cardOutline","codeWorkingOutline","locationOutline","mailOutline","peopleCircleOutline","personOutline","transgenderOutline","React","createUserAPI","getTestValueUser","User","InserirUtilizador","props","state","stateToAPI","nome_completo","email","password","localidade","nif","tipoDeSocio","genero","data_nascimento","categoria","loadingAPI","overflow","popup","newUser","passwordHash","setState","socio","user","parseInt","pass_enc","TextEncoder","encoded","encode","hash256","Buffer","from","toString","toUpperCase","then","res","status","alert","json","jsonData","console","log","finally","window","location","reload","require","split","length","e","ret","detail","value","target","event","preventDefault","createUserState","clearState","Component"],"mappings":"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","sourcesContent":["\nimport { IonButton, IonCol, IonContent, IonDatetime, IonGrid, IonHeader, IonIcon, IonInput, IonItem, IonLabel, IonLoading, IonPage, IonRow, IonSelect, IonSelectOption, IonText, IonTitle, IonToolbar } from \"@ionic/react\";\nimport sha256 from \"fast-sha256\";\nimport { calendarOutline, cardOutline, codeWorkingOutline, locationOutline, mailOutline, peopleCircleOutline, personOutline, transgenderOutline } from \"ionicons/icons\";\nimport React from \"react\";\nimport { createUserAPI } from \"../../models/API/UserAPI\";\nimport { getTestValueUser, User } from \"../../models/Other/User\";\nimport \"../css/InserirUtilizador.css\";\n\n\n//---------------------------------------------------------------------------------------------------------------------------------\n\nclass InserirUtilizador extends React.Component<any> {\n\n    state: {\n        nome_completo: string,\n        email: string,\n        password: string,\n        localidade: string,\n        nif: string,\n        tipoDeSocio: string,\n        genero: string,\n        data_nascimento: string,\n        categoria: string,\n        loadingAPI: false,\n        overflow : string,\n        popup : string\n    }\n\n    stateToAPI: {\n        newUser: User,\n        passwordHash: string                \n    }\n\n    constructor(props: any) {\n\n        super(props);\n\n        this.state = {\n            nome_completo: \"\",\n            email: \"\",\n            password: \"\",\n            localidade: \"\",\n            nif: \"\",\n            tipoDeSocio: \"\",\n            genero: \"\",\n            data_nascimento: \"1999-02-20\",\n            categoria: \"\",\n            loadingAPI: false,\n            overflow : \"\",\n            popup:\"\"\n        }\n\n        this.stateToAPI = {\n            newUser: getTestValueUser(),\n            passwordHash: \"\"\n        }  \n    }\n\n    createUserState() {\n\n        this.setState({\n            loadingAPI: true\n        });\n\n        var genero = -2;\n        switch(this.state.genero) {\n            case \"Masculino\": genero = 1; break; \n            case \"Feminino\":  genero = 0; break; \n            default:          genero = -1; break; \n        }\n\n        var categoria = \"NÃ£o tem\";\n        var socio = this.state.tipoDeSocio;\n        if (this.state.tipoDeSocio === \"Cliente Premium\") {\n            categoria = \"Premium\";\n            socio = \"Cliente\";\n        } else if (this.state.tipoDeSocio === \"Cliente Standard\") {\n            categoria = \"Standard\";\n            socio = \"Cliente\";\n        }\n\n        var user = new User(\n            socio,\n            this.state.email,\n            parseInt(this.state.nif),\n            this.state.nome_completo,\n            genero,\n            this.state.data_nascimento,\n            this.state.localidade,\n            categoria            \n        );\n\n        let pass_enc = new TextEncoder();\n        let encoded = pass_enc.encode(this.state.password);\n        let hash256 = Buffer.from(sha256(encoded)).toString('hex').toUpperCase();\n\n        this.stateToAPI = {\n            newUser: user,\n            passwordHash: hash256\n        }   \n\n        createUserAPI(this.stateToAPI).then(\n            \n            res => {\n                if (res.status===200 )alert(\"Criou um utilizador com sucesso!\"); else return alert(\"Credenciais Invalidas\");    \n                res.json()}            \n        ).then(\n        \n            (jsonData) => {\n                \n                this.setState({\n                    loadingAPI: false\n                });\n        \n                console.log(\"Got json:\");\n                console.log(jsonData);\n                \n            }\n            \n        )\n        .finally(()=>{window.location.reload();}\n        );\n        \n        \n        }\n\n    clearState() {\n        this.setState({\n            nome_completo: \"\",\n            email: \"\",\n            password: \"\",\n            localidade: \"\",\n            nif: \"\",\n            tipoDeSocio: \"\",\n            genero: \"\",\n            data_nascimento: \"1999-02-20\"\n        });        \n    }\n\n    render() {\n        return(\n            \n            <IonPage>\n\n                <IonHeader>\n                <IonToolbar color=\"primary\">\n                    <IonTitle id=\"page-title\">Novo Utilizador</IonTitle>\n                </IonToolbar>\n                </IonHeader>\n    \n                <IonContent className=\"PageContent\">\n\n                    <IonGrid className=\"PageGrid\">\n\n                        <IonRow>\n                            <IonCol size=\"2.5\" className=\"Row1ProfilePic\">\n                                \n                                <img className=\"profilePicture\" src={require('../../imgs/perfil_pic.png')} alt=\"Loading...\"/> \n                            \n                            </IonCol>\n\n                            <IonCol>\n\n                                <IonGrid>\n                                \n                                <div className=\"separador\"></div>\n                                    <IonRow>\n\n                                        <IonCol className=\"FirstForm\">\n\n                                            <IonItem>\n                                                <IonIcon slot=\"start\" icon={personOutline}></IonIcon>\n                                              <IonLabel position=\"floating\">Nome Completo   \n                                                    <IonText color=\"danger\">*</IonText>   \n        <IonText color={ (parseInt(this.state.overflow.split('/',1)[0])>=20)? \"danger\": \"secondary\"} >{this.state.overflow.length>0? '  ('+ this.state.overflow + ')' : \"\" }</IonText>\n                                              </IonLabel>\n                                                <IonInput required value={this.state.nome_completo} onIonChange={(e : any) => {\n                                                    var ret :string = e.detail.value!\n                                                    ret=ret.split(\" \",1)[0]\n                                                    this.setState({ overflow : ret.length>0? + ret.length+\"/20\" :\"\",nome_completo: e.detail.value! })\n                                                }}></IonInput>\n                                            </IonItem>                                           \n\n                                            <IonItem>\n                                                <IonIcon slot=\"start\" icon={mailOutline}></IonIcon>\n                                                <IonLabel position=\"floating\">E-Mail <IonText color=\"danger\">*</IonText></IonLabel>\n                                                <IonInput required type=\"email\" value={this.state.email} onIonChange={(e) => {\n                                                    this.setState({ email: (e.target as HTMLInputElement).value });\n                                                }}></IonInput>\n                                            </IonItem>                                           \n\n                                            <IonItem>\n                                                <IonIcon slot=\"start\" icon={codeWorkingOutline}></IonIcon>\n                                                <IonLabel position=\"floating\">Definir a password <IonText color=\"danger\">*</IonText></IonLabel>\n                                                <IonInput type=\"password\" required value={this.state.password} onIonChange={(e) => {\n                                                    this.setState({ password: (e.target as HTMLInputElement).value });\n                                                }}></IonInput>\n                                            </IonItem>                                           \n \n                                            <IonItem>\n                                                <IonIcon slot=\"start\" icon={locationOutline}></IonIcon>\n                                                <IonLabel position=\"floating\">Localidade</IonLabel>\n                                                <IonInput value={this.state.localidade} onIonChange={(e) => {\n                                                    this.setState({ localidade: (e.target as HTMLInputElement).value });\n                                                }}></IonInput>\n                                            </IonItem>                                           \n\n                                            <IonItem>\n                                                <IonIcon slot=\"start\" icon={cardOutline}></IonIcon>\n                                                <IonLabel position=\"floating\">Nif</IonLabel>\n                                                <IonInput required pattern=\"[0-9]*\" type=\"number\" value={this.state.nif} onIonChange={(e) => {\n                                                    this.setState({ nif: (e.target as HTMLInputElement).value });\n                                                }}></IonInput>\n                                            </IonItem>                                           \n                                           \n                                        </IonCol>\n\n                                    </IonRow>\n\n                                    <div className=\"separador\"></div>\n                                    <IonRow>\n                                        <IonCol>\n\n                                            <IonItem className=\"SelectUser\">\n                                                <IonIcon slot=\"start\" icon={peopleCircleOutline}></IonIcon>\n                                                <IonLabel>Tipo de sÃ³cio: </IonLabel>\n                                                <IonSelect value={this.state.tipoDeSocio} onIonChange={(e) => this.setState({ tipoDeSocio: e.detail.value! })}>\n                                                    <IonSelectOption value=\"Cliente Standard\">Cliente Standard</IonSelectOption>\n                                                    <IonSelectOption value=\"Cliente Premium\">Cliente Premium</IonSelectOption>\n                                                    <IonSelectOption value=\"Instrutor\">Instrutor</IonSelectOption>\n                                                    <IonSelectOption value=\"Rececionista\">Rececionista</IonSelectOption>\n                                                </IonSelect>\n                                            </IonItem>\n\n                                            <IonItem className=\"SelectGender\">\n                                                <IonIcon slot=\"start\" icon={transgenderOutline}></IonIcon>\n                                                <IonLabel>GÃ©nero: </IonLabel>\n                                                <IonSelect value={this.state.genero} onIonChange={(e) => this.setState({ genero: e.detail.value! })}>\n                                                    <IonSelectOption value=\"Masculino\">Masculino</IonSelectOption>\n                                                    <IonSelectOption value=\"Feminino\">Feminino</IonSelectOption>\n                                                    <IonSelectOption value=\"NÃ£o especificar\">NÃ£o especificar</IonSelectOption>\n                                                </IonSelect>\n                                            </IonItem>\n                                            \n                                            <IonItem className=\"SelectDate\">\n                                                <IonIcon slot=\"start\" icon={calendarOutline}></IonIcon>\n                                                <IonLabel><div className=\"textResponsive\">Data de Nasc.:</div></IonLabel>\n                                                <IonDatetime value={this.state.data_nascimento} onIonChange={(e) => {this.setState({ data_nascimento: e.detail.value! })}}></IonDatetime>\n\n                                            </IonItem>\n\n                                        </IonCol>\n\n                                    </IonRow>\n\n                                    <div className=\"separador\"></div>\n\n                                    <IonRow className=\"buttonWrapper\">\n\n                                        <IonCol>\n                                            <IonButton className=\"submitUser\" expand=\"block\" color=\"success\" onClick={(event) => {\n                                                event.preventDefault();\n                                                this.createUserState();\n\n                                            }}>Criar novo utilizador</IonButton>\n                                        </IonCol>\n\n                                        <IonCol>\n                                            <IonButton className=\"clearForm\" expand=\"block\" color=\"light\" onClick={() => {\n                                                this.clearState();\n                                            }}>Limpar formulÃ¡rio</IonButton>\n                                        </IonCol>\n\n                                    </IonRow>\n\n                                </IonGrid>\n\n                            </IonCol>\n                        </IonRow>\n\n                    </IonGrid>\n\n                    <IonLoading\n                        isOpen={this.state.loadingAPI}\n                        message={'Please wait...'}\n                        />\n\n                </IonContent>\n                \n            </IonPage>    \n        );\n    }\n}\n\nexport default InserirUtilizador;\n\n    /*\n        (nome + , email + , nif + , data_nasc, genero, categoria, localidade + ), \n        tipo (0:cliente, 1:instrutor, 2:rececionista)\n        hash password\n    */\n"]},"metadata":{},"sourceType":"module"}