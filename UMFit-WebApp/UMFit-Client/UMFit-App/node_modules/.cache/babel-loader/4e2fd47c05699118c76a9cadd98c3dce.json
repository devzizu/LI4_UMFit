{"ast":null,"code":"import _slicedToArray from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/node_modules/@babel/runtime/helpers/esm/inherits\";import{IonAlert,IonButton,IonButtons,IonCard,IonCardHeader,IonCardTitle,IonContent,IonDatetime,IonHeader,IonIcon,IonItem,IonLabel,IonList,IonLoading,IonMenuButton,IonPage,IonRow,IonSearchbar,IonTitle,IonToolbar}from\"@ionic/react\";import{calendarOutline,personCircle,personCircleOutline}from\"ionicons/icons\";import React from\"react\";import{getAvaliacoesAgendadas,setAvaliacao}from\"../../models/API/EvolucaoAPI\";import{getInstrutores}from\"../../models/API/UserAPI\";import'./css/AgendarAvaliacao.css';var avalInicial={data:new Date().toLocaleString(),instrutor_nome:\"\",instrutor_email:\"\"};var searchInit={query:\"\",list_init:[],list_now:[]};var AgendarAvaliacao=/*#__PURE__*/function(_React$Component){_inherits(AgendarAvaliacao,_React$Component);function AgendarAvaliacao(props){var _this;_classCallCheck(this,AgendarAvaliacao);_this=_possibleConstructorReturn(this,_getPrototypeOf(AgendarAvaliacao).call(this,props));_this.state=void 0;_this.state={email:props.email,aval:avalInicial,avals:[],instrutores:new Map(),pickInstrutor:searchInit,loading:\"\",alert:\"\"};return _this;}_createClass(AgendarAvaliacao,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var avals,map,pick,res,res2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:avals=[];map=new Map();pick=this.state.pickInstrutor;_context.next=5;return getAvaliacoesAgendadas(this.state.email);case 5:res=_context.sent;_context.next=8;return getInstrutores();case 8:res2=_context.sent;_context.next=11;return res.json().then(function(data){avals=JSON.parse(data).avaliacoes;});case 11:_context.next=13;return res2.json().then(function(data){var ret=data.instrutores;var i;for(i in ret){map.set(i,ret[i]);pick.list_init.push(ret[i]);if(pick.list_now.length<3)pick.list_now.push(ret[i]);}});case 13:this.setState({avals:avals,pickInstrutor:pick,instrutores:map});case 14:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"setDate\",value:function setDate(date){var aval=this.state.aval;aval.data=date;this.setState({aval:aval});}},{key:\"setQuery\",value:function setQuery(query){console.log(this.state);var pick=this.state.pickInstrutor;pick.query=query;if(query===\"\"){pick.list_now=pick.list_init.copyWithin(0,0).slice(0,3);}else{pick.list_now=this.state.pickInstrutor.list_init.filter(function(value){return value.toLowerCase().indexOf(query.toLowerCase())>=0;}).slice(0,40);}this.setState({pickInstrutor:pick});}},{key:\"selectInstrutor\",value:function(){var _selectInstrutor=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(nome){var mail,aval,resetSearch,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,_step$value,m,n;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:mail=\"\";aval=this.state.aval;resetSearch={query:\"\",list_now:[],list_init:this.state.pickInstrutor.list_init};_iteratorNormalCompletion=true;_didIteratorError=false;_iteratorError=undefined;_context2.prev=6;_iterator=this.state.instrutores.entries()[Symbol.iterator]();case 8:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context2.next=16;break;}_step$value=_slicedToArray(_step.value,2),m=_step$value[0],n=_step$value[1];if(!(n===nome)){_context2.next=13;break;}mail=m;return _context2.abrupt(\"break\",16);case 13:_iteratorNormalCompletion=true;_context2.next=8;break;case 16:_context2.next=22;break;case 18:_context2.prev=18;_context2.t0=_context2[\"catch\"](6);_didIteratorError=true;_iteratorError=_context2.t0;case 22:_context2.prev=22;_context2.prev=23;if(!_iteratorNormalCompletion&&_iterator.return!=null){_iterator.return();}case 25:_context2.prev=25;if(!_didIteratorError){_context2.next=28;break;}throw _iteratorError;case 28:return _context2.finish(25);case 29:return _context2.finish(22);case 30:aval.instrutor_email=mail;aval.instrutor_nome=nome;this.setState({aval:aval,pickInstrutor:resetSearch});case 33:case\"end\":return _context2.stop();}}},_callee2,this,[[6,18,22,30],[23,,25,29]]);}));function selectInstrutor(_x){return _selectInstrutor.apply(this,arguments);}return selectInstrutor;}()},{key:\"setAgendacao\",value:function setAgendacao(){var _this2=this;this.setState({loading:\"A criar plano...\"});setAvaliacao(this.state.email,this.state.aval).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(value){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Agendar response value: \\n\");console.log(value);_this2.setState({loading:\"\"});_context3.t0=value.status;_context3.next=_context3.t0===200?6:_context3.t0===400?8:10;break;case 6:_this2.setState({alert:\"Avaliação marcada!\"});return _context3.abrupt(\"break\",10);case 8:_this2.setState({alert:\"Verifique se os campos estão válidos...\"});return _context3.abrupt(\"break\",10);case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref.apply(this,arguments);};}());//alert(\"Avaliação Marcada\");\nthis.componentDidMount();}},{key:\"render\",value:function render(){var _this3=this;var localVals=this.state.avals;return React.createElement(IonPage,null,React.createElement(IonHeader,null,React.createElement(IonToolbar,{color:\"primary\"},React.createElement(IonButtons,{slot:\"start\"},React.createElement(IonMenuButton,null)),React.createElement(IonTitle,{id:\"page-title\"},\"Agendar\"))),React.createElement(IonContent,null,React.createElement(IonLoading,{isOpen:this.state.loading!==\"\",onDidDismiss:function onDidDismiss(){_this3.setState({loading:\"\"});},message:this.state.loading}),React.createElement(IonAlert,{isOpen:this.state.alert!==\"\",onDidDismiss:function onDidDismiss(){return _this3.setState({alert:\"\"});},header:'Aviso',message:this.state.alert,buttons:['Ok, percebido!']}),React.createElement(IonCard,{className:\"cardAval\"},React.createElement(IonCardHeader,null,React.createElement(IonItem,null,React.createElement(IonCardTitle,{className:\"cardTitle\"},React.createElement(\"b\",null,\"Agendar Avalia\\xE7\\xE3o\"),\" \"),React.createElement(IonButton,{color:\"success\",onClick:function onClick(){return _this3.setAgendacao();},slot:\"end\"},\"Submeter\"))),React.createElement(IonItem,null,React.createElement(IonIcon,{icon:calendarOutline}),React.createElement(IonLabel,{className:\"data\"},\" \",React.createElement(\"b\",null,\"\\xA0\"),\"Data:\"),React.createElement(IonDatetime,{displayFormat:\"DD-MM-YYYY HH:mm\",value:this.state.aval.data,onIonChange:function onIonChange(e){return _this3.setDate(e.detail.value);}})),React.createElement(IonItem,null,React.createElement(IonIcon,{icon:personCircleOutline}),React.createElement(IonLabel,null,\"\\xA0Instrutor:\"),React.createElement(IonLabel,{slot:\"end\"},this.state.aval.instrutor_nome)),React.createElement(IonItem,null,React.createElement(IonLabel,null,\"Instrutor:\"),React.createElement(IonToolbar,null,React.createElement(IonSearchbar,{value:this.state.pickInstrutor.query,onIonChange:function onIonChange(e){return _this3.setQuery(e.detail.value);},placeholder:\"Email do instrutor...\"}))),this.state.pickInstrutor.list_now.length!==0?React.createElement(IonItem,null,React.createElement(IonList,null,this.state.pickInstrutor.list_now.map(function(element){return React.createElement(IonItem,{key:element,className:\"item\",button:true,onClick:function onClick(){return _this3.selectInstrutor(element);}},React.createElement(IonIcon,{className:\"icon\",icon:personCircle}),React.createElement(IonLabel,{color:\"primary\"},element));}))):React.createElement(React.Fragment,null)),React.createElement(IonRow,{className:\"avalRow\"},localVals.map(function(elem){return React.createElement(IonCard,{key:elem.data+elem.instrutor_nome,className:\"cardCol\"},React.createElement(IonItem,null,React.createElement(IonIcon,{icon:calendarOutline}),React.createElement(IonLabel,null,\"\\xA0Data: \",elem.data)),React.createElement(IonItem,null,React.createElement(IonIcon,{icon:personCircleOutline}),React.createElement(IonLabel,null,\"\\xA0Instrutor: \",elem.instrutor_nome)));})),React.createElement(IonCard,{className:\"cardAval\"})));}}]);return AgendarAvaliacao;}(React.Component);export default AgendarAvaliacao;","map":{"version":3,"sources":["/home/hc/Desktop/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/pages/user/AgendarAvaliacao.tsx"],"names":["IonAlert","IonButton","IonButtons","IonCard","IonCardHeader","IonCardTitle","IonContent","IonDatetime","IonHeader","IonIcon","IonItem","IonLabel","IonList","IonLoading","IonMenuButton","IonPage","IonRow","IonSearchbar","IonTitle","IonToolbar","calendarOutline","personCircle","personCircleOutline","React","getAvaliacoesAgendadas","setAvaliacao","getInstrutores","avalInicial","data","Date","toLocaleString","instrutor_nome","instrutor_email","searchInit","query","list_init","list_now","AgendarAvaliacao","props","state","email","aval","avals","instrutores","Map","pickInstrutor","loading","alert","map","pick","res","res2","json","then","JSON","parse","avaliacoes","ret","i","set","push","length","setState","date","console","log","copyWithin","slice","filter","value","toLowerCase","indexOf","nome","mail","resetSearch","entries","m","n","status","componentDidMount","localVals","setAgendacao","e","setDate","detail","setQuery","element","selectInstrutor","elem","Component"],"mappings":"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","sourcesContent":["import { IonAlert, IonButton, IonButtons, IonCard, IonCardHeader, IonCardTitle, IonContent, IonDatetime, IonHeader, IonIcon, IonItem, IonLabel, IonList, IonLoading, IonMenuButton, IonPage, IonRow, IonSearchbar, IonTitle, IonToolbar } from \"@ionic/react\";\nimport { calendarOutline, personCircle, personCircleOutline } from \"ionicons/icons\";\nimport React from \"react\";\nimport { getAvaliacoesAgendadas, setAvaliacao } from \"../../models/API/EvolucaoAPI\";\nimport { getInstrutores } from \"../../models/API/UserAPI\";\nimport './css/AgendarAvaliacao.css';\n\n\n\nexport interface AvaliacaoAgendada{\n    data : string\n    instrutor_nome : string\n    instrutor_email : string\n}\n\n\ninterface SearchBar{\n    query : string;\n    list_init : string[];\n    list_now : string[]\n}\nconst avalInicial : AvaliacaoAgendada  = {\n    data : new Date().toLocaleString(),\n    instrutor_nome : \"\",\n    instrutor_email: \"\"\n}\nconst searchInit : SearchBar = {\n    query : \"\",\n    list_init : [],\n    list_now : []\n}\n\nclass AgendarAvaliacao extends React.Component<any>{\n    state:{\n        email : string;\n        aval : AvaliacaoAgendada;\n        avals : AvaliacaoAgendada[];\n        instrutores : Map<string,string>;\n       pickInstrutor : SearchBar;\n       alert: string\n       loading: string\n       \n    }\n\n    constructor(props : any){\n        super(props);\n        this.state={\n            email :props.email,\n            aval : avalInicial,\n            avals : [],\n            instrutores : new Map(),\n            pickInstrutor : searchInit,\n            loading: \"\",\n            alert:\"\"\n        }\n    }\n    \n    async componentDidMount(){\n        var avals : AvaliacaoAgendada[] =[];\n        var map : Map<string,string> = new Map<string,string>() ;\n        var pick : SearchBar = this.state.pickInstrutor;\n        const res = (await getAvaliacoesAgendadas(this.state.email));\n        const res2 = (await getInstrutores());\n        await res.json().then((data)=>{\n\n            avals = JSON.parse(data).avaliacoes;\n        });\n        await res2.json().then((data)=>{\n            var ret = data.instrutores;\n            var i;\n            for( i in ret){\n           map.set(i,ret[i]);\n           pick.list_init.push(ret[i]);\n           if (pick.list_now.length<3) pick.list_now.push(ret[i]);\n        }\n        });\n\n        \n        this.setState({ avals: avals, pickInstrutor :pick ,instrutores : map });\n    }\n\n    setDate(date : string){\n        var aval : AvaliacaoAgendada = this.state.aval;\n        aval.data=date;\n        this.setState({aval : aval });\n    }\n    setQuery(query : string){\n        console.log(this.state);\n        var pick = this.state.pickInstrutor;\n        pick.query = query;\n        if(query===\"\"){pick.list_now= pick.list_init.copyWithin(0,0).slice(0,3)}\n            else{\n        pick.list_now = (this.state.pickInstrutor.list_init.filter((value)=> value.toLowerCase().indexOf(query.toLowerCase()) >= 0)).slice(0,40);}\n        this.setState({\n            pickInstrutor : pick\n        })\n\n    }\n   async selectInstrutor(nome: string) {\n     var mail:string =\"\"\n        var aval = this.state.aval;\n        var resetSearch :SearchBar ={query: \"\",list_now :[],list_init : this.state.pickInstrutor.list_init } \n\n        for(var [m,n] of this.state.instrutores.entries())\n        if(n===nome){mail=m; break;}\n    \n\n        aval.instrutor_email = mail;    \n        aval.instrutor_nome = nome;\n        this.setState({ aval: aval, pickInstrutor: resetSearch })\n    }\n\n    setAgendacao() {\n        this.setState({loading : \"A criar plano...\"});\n        setAvaliacao(this.state.email,this.state.aval).then(\n            async (value: any) => {\n                console.log(\"Agendar response value: \\n\");\n                console.log(value)\n                this.setState({loading:\"\"})\n                switch (value.status){\n                    case 200 : this.setState({alert : \"Avaliação marcada!\"});break;\n                    case 400 : this.setState({alert :\"Verifique se os campos estão válidos...\"}); break;\n                }})\n\n        //alert(\"Avaliação Marcada\");\n        this.componentDidMount();\n    }\n\n\n    render(){\n       \n        var localVals = this.state.avals;\n    \n        return(\n            <IonPage>\n\n            <IonHeader>\n                <IonToolbar color=\"primary\">\n                <IonButtons slot=\"start\">\n                    <IonMenuButton />\n                </IonButtons>\n                <IonTitle id=\"page-title\">Agendar</IonTitle>\n                </IonToolbar>\n                </IonHeader>\n        <IonContent>\n        <IonLoading\n      isOpen={this.state.loading!==\"\"}\n      onDidDismiss={() => {this.setState({loading: \"\"})}}\n      message={this.state.loading}\n    />\n        <IonAlert\n          isOpen={this.state.alert!==\"\"}\n          onDidDismiss={() => this.setState({alert : \"\"})}\n          header={'Aviso'}\n          message={this.state.alert}\n          buttons={['Ok, percebido!']}\n        />\n    <IonCard className=\"cardAval\">\n        <IonCardHeader>\n            <IonItem>\n        <IonCardTitle className = \"cardTitle\"><b>Agendar Avaliação</b> </IonCardTitle>\n        <IonButton color=\"success\" onClick={()=>this.setAgendacao()} slot=\"end\">\n            Submeter\n        </IonButton>\n        </IonItem>\n        </IonCardHeader>\n        <IonItem>\n\n        <IonIcon icon={calendarOutline}></IonIcon>\n        <IonLabel className=\"data\" > <b>&nbsp;</b>Data:</IonLabel>\n              <IonDatetime  displayFormat=\"DD-MM-YYYY HH:mm\" value={this.state.aval.data} onIonChange={e => this.setDate(e.detail.value!)}></IonDatetime>\n\n        </IonItem>\n        <IonItem>\n        <IonIcon icon={personCircleOutline}></IonIcon>\n        <IonLabel>\n        &nbsp;Instrutor: \n        </IonLabel>\n        <IonLabel slot=\"end\">\n              {this.state.aval.instrutor_nome}\n        </IonLabel>\n        \n        </IonItem>\n        \n        <IonItem>\n              <IonLabel>Instrutor:</IonLabel>\n              <IonToolbar>\n                    <IonSearchbar value={this.state.pickInstrutor.query} onIonChange={e => this.setQuery(e.detail.value!)} placeholder=\"Email do instrutor...\">\n                    </IonSearchbar>\n            </IonToolbar>\n        </IonItem>{this.state.pickInstrutor.list_now.length!==0? (\n        \n        <IonItem>\n            <IonList>\n                    {this.state.pickInstrutor.list_now.map(\n                    (element)=> { return(\n                    <IonItem key={element} className=\"item\" button={true}  onClick={() =>this.selectInstrutor(element)}>\n                        <IonIcon className=\"icon\" icon ={personCircle}></IonIcon>\n                        <IonLabel color=\"primary\" >{element}</IonLabel>\n                    </IonItem>\n                    )}\n                    )}\n    </IonList>\n    </IonItem>\n            ):(<React.Fragment></React.Fragment>) }\n            \n\n</IonCard>\n\n<IonRow className=\"avalRow\">\n{localVals.map((elem)=>\n    \n    <IonCard key={elem.data + elem.instrutor_nome} className=\"cardCol\">\n    <IonItem><IonIcon icon={calendarOutline }></IonIcon><IonLabel>&nbsp;Data: {elem.data}</IonLabel></IonItem>\n    <IonItem><IonIcon icon={personCircleOutline}></IonIcon><IonLabel>&nbsp;Instrutor: {elem.instrutor_nome}</IonLabel></IonItem>\n    </IonCard>\n   \n)}\n</IonRow>\n\n<IonCard className = \"cardAval\">\n\n</IonCard>\n</IonContent>\n\n</IonPage>\n        )\n}\n    \n}\n\nexport default AgendarAvaliacao;"]},"metadata":{},"sourceType":"module"}