{"ast":null,"code":"var _jsxFileName = \"/home/joao/Desktop/Projeto-LI4/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/App.tsx\";\nimport React, { useState } from 'react';\nimport { Redirect, Route } from 'react-router-dom';\nimport { IonApp, IonRouterOutlet, IonSplitPane, IonPage, IonHeader, IonToolbar, IonTitle, IonText, IonInput, IonButton } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\n/* Core CSS required for Ionic components to work properly */\n\nimport '@ionic/react/css/core.css';\n/* Basic CSS for apps built with Ionic */\n\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n/* Optional CSS utils that can be commented out */\n\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n/* Theme variables */\n\nimport './theme/variables.css'; //---------------------------------------------------------------------------------------\n//---------------------------------------------------------------------------------------\n\nimport { authenticate, getUserStatus } from './models/API/UserAPI';\nimport { formatUser } from './models/Other/User';\nimport sha256 from \"fast-sha256\"; //---------------------------------------------------------------------------------------\n//---------------------------------------------------------------------------------------\n\nimport './components/css/LogIn.css';\nimport './pages/css/Home.css';\nimport Menu from './components/MenuHome';\nimport About from './pages/About';\nimport Contact from './pages/Contact';\nimport UserProfile, { Avaliacoes } from './pages/UserProfile'; //---------------------------------------------------------------------------------------\n\nvar change = false;\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      selectedPage: '',\n      menus: 'home',\n      isUserLogged: false,\n      loadingAPIcall: true\n    };\n  }\n\n  componentDidMount() {\n    console.log(\"com..DidMount() -> updating state...\");\n    getUserStatus(\"test\").then(res => res.json()).then(data => {\n      if (data.status === \"online\") {\n        this.setState({\n          isUserLogged: true,\n          loadingAPIcall: false\n        });\n      } else {\n        this.setState({\n          isUserLogged: false,\n          loadingAPIcall: false\n        });\n      }\n    });\n  }\n\n  render() {\n    console.log(\"[...] Rendering App component...\");\n    return React.createElement(IonApp, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(IonReactRouter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(IonSplitPane, {\n      id: \"split-pane\",\n      contentId: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(Menu, {\n      selectedPage: this.state.selectedPage,\n      menus: change ? 'user' : 'home',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }), React.createElement(IonRouterOutlet, {\n      id: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: \"/home\",\n      component: () => {\n        change = false;\n        return React.createElement(Home, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        });\n      },\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/about\",\n      component: About,\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/contact\",\n      component: Contact,\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      component: Home,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/profile\",\n      component: () => {\n        console.log(\"0. Running /profile with:\");\n        console.log(\"1. Loading API? = \" + this.state.loadingAPIcall);\n        console.log(\"2. User is logged = \" + this.state.isUserLogged);\n        console.log(\"3. Change to user menus? \" + change);\n\n        if (this.state.isUserLogged) {\n          change = true;\n        } else {\n          window.location.href = \"/home\";\n          change = false;\n        }\n\n        return this.state.isUserLogged ? React.createElement(UserProfile, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }) : React.createElement(Home, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    })))));\n  }\n\n}\n\n;\nexport default App; //---------------------------------------------------------------------------------------\n\nclass Home extends React.Component {\n  render() {\n    return React.createElement(IonPage, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(IonHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(IonToolbar, {\n      color: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(IonTitle, {\n      id: \"page-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"UMFit\"))), React.createElement(LogIn, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }));\n  }\n\n}\n\n; //---------------------------------------------------------------------------------------\n\nclass Profile extends React.Component {\n  render() {\n    return React.createElement(IonRouterOutlet, {\n      id: \"main\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: \"/profile\",\n      component: UserProfile,\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/aval\",\n      component: Avaliacoes,\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }));\n  }\n\n} //---------------------------------------------------------------------------------------\n\n\nconst LogIn = () => {\n  const [logged, setLogged] = useState(false);\n  const [emailValue, setEmailValue] = useState(\"\");\n  const [passwordValue, setPasswordValue] = useState(\"\");\n\n  if (logged) {\n    return React.createElement(Redirect, {\n      to: \"/profile\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    });\n  } else return React.createElement(\"div\", {\n    id: \"login-form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    id: \"Logo\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    id: \"phrase\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(IonText, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, \"O teu gin\\xE1sio da UMinho...\")), React.createElement(\"div\", {\n    id: \"input-form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }), React.createElement(IonInput, {\n    required: true,\n    type: \"email\",\n    id: \"email-input\",\n    placeholder: \"E-Mail\",\n    value: emailValue,\n    onIonChange: e => {\n      setEmailValue(e.target.value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210\n    },\n    __self: this\n  }), React.createElement(IonInput, {\n    required: true,\n    type: \"password\",\n    id: \"pass-input\",\n    placeholder: \"Password\",\n    value: passwordValue,\n    onIonChange: e => {\n      setPasswordValue(e.target.value);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  })), React.createElement(IonButton, {\n    expand: \"block\",\n    type: \"submit\",\n    id: \"login-button\",\n    onClick: async () => {\n      //setShowLoading(true);\n      let pass_enc = new TextEncoder();\n      let encoded = pass_enc.encode(passwordValue);\n      let hash256 = Buffer.from(sha256(encoded)).toString('hex').toUpperCase();\n      console.log(\"Para a API: /api/user/authenticate\");\n      console.log(\"> E-Mail: \" + emailValue);\n      console.log(\"> Password: \" + passwordValue);\n      console.log(\"> Password (sha256): \" + hash256); //request\n\n      let response = authenticate(emailValue, passwordValue);\n      await response.then(async function (value) {\n        //Success OK = 200    \n        if (value.status === 200) {\n          var json = value.json();\n          await json.then(async function (value) {\n            let user = formatUser(value);\n            console.log(user); //Esta loggado:\n\n            setLogged(true);\n          }); //Login error: 400    \n        } else {\n          alert(\"E-mail ou password incorretos...\");\n        }\n      });\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"Log-In\"));\n};","map":{"version":3,"sources":["/home/joao/Desktop/Projeto-LI4/li4_umfit/UMFit-WebApp/UMFit-Client/UMFit-App/src/App.tsx"],"names":["React","useState","Redirect","Route","IonApp","IonRouterOutlet","IonSplitPane","IonPage","IonHeader","IonToolbar","IonTitle","IonText","IonInput","IonButton","IonReactRouter","authenticate","getUserStatus","formatUser","sha256","Menu","About","Contact","UserProfile","Avaliacoes","change","App","Component","state","selectedPage","menus","isUserLogged","loadingAPIcall","componentDidMount","console","log","then","res","json","data","status","setState","render","Home","window","location","href","Profile","LogIn","logged","setLogged","emailValue","setEmailValue","passwordValue","setPasswordValue","e","target","value","pass_enc","TextEncoder","encoded","encode","hash256","Buffer","from","toString","toUpperCase","response","user","alert"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Redirect, Route } from 'react-router-dom';\nimport { IonApp, IonRouterOutlet, IonSplitPane, IonPage, IonHeader, IonToolbar, IonTitle, IonText, IonInput, IonButton } from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\n\n//---------------------------------------------------------------------------------------\n//---------------------------------------------------------------------------------------\n\nimport { authenticate, getUserStatus } from './models/API/UserAPI';\nimport { User, formatUser } from './models/Other/User';\n\nimport sha256 from \"fast-sha256\";\n\n//---------------------------------------------------------------------------------------\n//---------------------------------------------------------------------------------------\n\nimport './components/css/LogIn.css';\nimport './pages/css/Home.css';\n\nimport Menu from './components/MenuHome';\nimport About from './pages/About';\nimport Contact from './pages/Contact';\nimport UserProfile, { Avaliacoes } from './pages/UserProfile';\n\n//---------------------------------------------------------------------------------------\n\nvar change = false;\n\nclass App extends React.Component {\n\n  state = {\n    selectedPage: '',\n    menus: 'home',\n    isUserLogged: false,\n    loadingAPIcall: true\n  }\n\n  componentDidMount() {\n\n    console.log(\"com..DidMount() -> updating state...\");\n\n    getUserStatus(\"test\")\n      .then(res => res.json())\n      .then((data) => {\n\n        if (data.status === \"online\") {\n          this.setState({\n            isUserLogged: true,\n            loadingAPIcall: false\n          });\n        } else {\n          this.setState({\n\n            isUserLogged: false,\n            loadingAPIcall: false\n          });\n        }\n\n      });\n  }\n\n  render() {\n\n    console.log(\"[...] Rendering App component...\");\n\n    return (\n    \n      <IonApp>\n\n        <IonReactRouter>\n          \n          <IonSplitPane id=\"split-pane\" contentId=\"main\">\n            <Menu selectedPage={this.state.selectedPage} menus={change ? 'user' : 'home'}/>\n              \n              <IonRouterOutlet id=\"main\">\n                \n                <Route path=\"/home\" component={()=> {\n                  change = false;\n                  return <Home />;\n                }} exact={true} />\n                <Route path=\"/about\" component={About} exact={true} />\n                <Route path=\"/contact\" component={Contact} exact={true} />                          \n                <Route exact path=\"/\" component={Home} />\n\n                <Route exact path=\"/profile\" component={() => {\n                  \n                  console.log(\"0. Running /profile with:\");\n                  console.log(\"1. Loading API? = \" + this.state.loadingAPIcall);\n                  console.log(\"2. User is logged = \" + this.state.isUserLogged);\n                  console.log(\"3. Change to user menus? \" + change);\n\n                  if (this.state.isUserLogged) {\n\n                    change = true;\n                  }\n                  else {\n                    window.location.href = \"/home\"\n                    change = false;\n                  }\n                  return this.state.isUserLogged ? \n                    <UserProfile /> : <Home />;\n\n                }} />\n\n              </IonRouterOutlet>\n\n\n          </IonSplitPane>\n        </IonReactRouter>\n      </IonApp>\n    );\n  }\n};\n\nexport default App;\n\n//---------------------------------------------------------------------------------------\n\nclass Home extends React.Component {\n\n  render() {\n\n    return (\n      <IonPage>\n\n\n        <IonHeader>\n          <IonToolbar color=\"primary\">\n            <IonTitle id=\"page-title\">UMFit</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n\n        <LogIn />\n\n      </IonPage>\n    );\n  }\n\n};\n\n//---------------------------------------------------------------------------------------\n\nclass Profile extends React.Component {\n\n  render() {\n    \n    return(\n              \n        <IonRouterOutlet id=\"main\">\n\n          <Route path=\"/profile\" component={UserProfile} exact={true} />\n\n          <Route path=\"/aval\" component={Avaliacoes} exact={true} />\n\n        </IonRouterOutlet>\n      \n    );    \n  }\n\n}\n\n//---------------------------------------------------------------------------------------\n\nconst LogIn: React.FC = () => {\n\n  const [logged, setLogged] = useState(false);\n  const [emailValue, setEmailValue] = useState<string>(\"\");\n  const [passwordValue, setPasswordValue] = useState<string>(\"\");\n\n  if (logged) {\n\n    return <Redirect to='/profile' />;\n\n  } else\n    \n    return (\n      \n      <div id=\"login-form\">\n          <div id=\"Logo\"></div>\n          <div id=\"phrase\">\n              <IonText>O teu ginásio da UMinho...</IonText>\n          </div>\n      <div id=\"input-form\">\n          <br></br>\n          <IonInput required type=\"email\" id=\"email-input\" placeholder=\"E-Mail\"\n          value={emailValue}\n          onIonChange={(e) => {\n              setEmailValue((e.target as HTMLInputElement).value);\n          }}>\n          </IonInput>\n          <br></br>\n          <IonInput required type=\"password\" id=\"pass-input\" placeholder=\"Password\"\n          value={passwordValue}\n          onIonChange={(e) => {\n              setPasswordValue((e.target as HTMLInputElement).value);\n          }}>\n          </IonInput>\n      </div>\n      <IonButton expand=\"block\" type=\"submit\" id=\"login-button\" onClick={async () => {\n              \n              //setShowLoading(true);\n\n              let pass_enc = new TextEncoder();\n              let encoded = pass_enc.encode(passwordValue);\n              let hash256 = Buffer.from(sha256(encoded)).toString('hex').toUpperCase();\n\n              console.log(\"Para a API: /api/user/authenticate\");\n              console.log(\"> E-Mail: \" + emailValue);\n              console.log(\"> Password: \" + passwordValue);\n              console.log(\"> Password (sha256): \" + hash256);\n\n              //request\n              let response = authenticate(emailValue, passwordValue);\n\n              await response.then(async function(value) {\n                  \n                  //Success OK = 200    \n                  if (value.status === 200) {\n                                   \n                      var json = value.json();\n                      \n                      await json.then(async function(value) {\n                          \n                          let user: User = formatUser(value);\n                          \n                          console.log(user);\n\n                          //Esta loggado:\n\n                          setLogged(true);\n   \n                      });\n\n                  //Login error: 400    \n                  } else {\n\n                      alert(\"E-mail ou password incorretos...\");\n\n                  }\n              });\n\n          }\n      }>\n          Log-In\n      </IonButton>\n      </div> \n  );\n  \n};\n"]},"metadata":{},"sourceType":"module"}